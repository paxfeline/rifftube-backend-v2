{"ast":null,"code":"import React,{useEffect}from'react';import{connect}from'react-redux';import{GoogleLogout}from'react-google-login';import RiffList from'./RiffList.js';import EditRiff from'./EditRiff.js';import RiffButton from'./RiffButton.js';import{setRifferName,googleUserLogout}from'../../actions';// this and below are the same file\nimport{EDIT_MODE,EDIT_NEW_MODE}from'../../actions';import{createTempRiff,togglePlayerMode,setRecorder}from'../../actions/index.js';/*This component houses all of the riff buttons and the rifflist*/function EditControls(props){useEffect(function(){var blurEvent=function blurEvent(){setTimeout(function(){document.activeElement.blur();},100);};window.addEventListener('blur',blurEvent);var keydownEvent=function keydownEvent(e){console.log(props.mode);if(e.key==='r')props.createTempRiff('audio',props.videoID,true);else if(e.key==='t')props.createTempRiff('text',props.videoID);else if(props.mode===EDIT_MODE||props.mode===EDIT_NEW_MODE)return;else if(e.key==='j'||e.key==='ArrowLeft'||e.key==='Left')// I actually took MS specific BS into account\nwindow.rifftubePlayer.seekTo(Math.max(window.rifftubePlayer.getCurrentTime()-5,0),true);else if(e.key==='l'||e.key==='ArrowRight'||e.key==='Right')window.rifftubePlayer.seekTo(Math.min(window.rifftubePlayer.getCurrentTime()+5,props.duration),true);else if(e.key===' '||e.key==='k'){props.togglePlayerMode();e.preventDefault();}};window.addEventListener('keydown',keydownEvent);return function(){window.removeEventListener('blur',blurEvent);window.removeEventListener('keydown',keydownEvent);};},[props]);return/*#__PURE__*/React.createElement(\"div\",{className:\"control-panel\"},// make this into a component?:\nprops.name?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"riffer-name\"},\"Riffer Name:\\xA0\",props.name),/*#__PURE__*/React.createElement(GoogleLogout,{clientId:\"941154439836-s6iglcrdckcj6od74kssqsom58j96hd8.apps.googleusercontent.com\",buttonText:\"Logout\",onLogoutSuccess:function onLogoutSuccess(){return props.googleUserLogout();}})):null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",{className:\"add-riff-title\"},\"Add New Riff\"),props.recorder!==null?/*#__PURE__*/React.createElement(RiffButton,{type:\"audio\"}):/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){var AudioContext=window.AudioContext||window.webkitAudioContext;// Default // Safari and old versions of Chrome\nvar audioContext=new AudioContext();if(navigator.mediaDevices){navigator.mediaDevices.getUserMedia({audio:true,video:false}).then(function(stream){// gum (get user media)\nvar input=audioContext.createMediaStreamSource(stream);var recorder=new window.WebAudioRecorder(input,{workerDir:'/lib/',encoding:'mp3',onEncoderLoading:function onEncoderLoading(recorder,encoding){// show \"loading encoder...\" display\nconsole.log('Loading '+encoding+' encoder...');},onEncoderLoaded:function onEncoderLoaded(recorder,encoding){// hide \"loading encoder...\" display\nconsole.log(encoding+' encoder loaded');}});props.setRecorder(recorder);}).catch(function(err){//enable the record button if getUSerMedia() fails\nconsole.log(\"oops, can't get stream\",err);});}}},\"Click to allow recording\"),/*#__PURE__*/React.createElement(RiffButton,{type:\"text\"}),props.mode===EDIT_MODE||props.mode===EDIT_NEW_MODE?/*#__PURE__*/React.createElement(EditRiff,null):null),/*#__PURE__*/React.createElement(\"h2\",{className:\"riff-list-title\"},\"Control Panel\"),/*#__PURE__*/React.createElement(RiffList,null));}var mapStateToProps=function mapStateToProps(state){return{mode:state.mode,name:state.name,googleUser:state.googleUser,videoID:state.videoID,duration:state.duration,recorder:state.recorder};};var mapDispatchToProps={setRifferName:setRifferName,googleUserLogout:googleUserLogout,createTempRiff:createTempRiff,togglePlayerMode:togglePlayerMode,setRecorder:setRecorder};export default connect(mapStateToProps,mapDispatchToProps)(EditControls);","map":{"version":3,"names":["React","useEffect","connect","GoogleLogout","RiffList","EditRiff","RiffButton","setRifferName","googleUserLogout","EDIT_MODE","EDIT_NEW_MODE","createTempRiff","togglePlayerMode","setRecorder","EditControls","props","blurEvent","setTimeout","document","activeElement","blur","window","addEventListener","keydownEvent","e","console","log","mode","key","videoID","rifftubePlayer","seekTo","Math","max","getCurrentTime","min","duration","preventDefault","removeEventListener","name","recorder","AudioContext","webkitAudioContext","audioContext","navigator","mediaDevices","getUserMedia","audio","video","then","stream","input","createMediaStreamSource","WebAudioRecorder","workerDir","encoding","onEncoderLoading","onEncoderLoaded","catch","err","mapStateToProps","state","googleUser","mapDispatchToProps"],"sources":["/Users/davidnewberry/Documents/test_rails/frontend/src/components/RiffControls/EditControls.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { GoogleLogout } from 'react-google-login';\n\nimport RiffList from './RiffList.js';\nimport EditRiff from './EditRiff.js';\nimport RiffButton from './RiffButton.js';\nimport { setRifferName, googleUserLogout } from '../../actions'; // this and below are the same file\nimport { EDIT_MODE, EDIT_NEW_MODE } from '../../actions';\n\nimport { createTempRiff, togglePlayerMode, setRecorder } from '../../actions/index.js';\n\n/*This component houses all of the riff buttons and the rifflist*/\nfunction EditControls(props) {\n  useEffect(() => {\n    const blurEvent = () => {\n      setTimeout(() => {\n        document.activeElement.blur();\n      }, 100);\n    };\n    window.addEventListener('blur', blurEvent);\n    const keydownEvent = (e) => {\n      console.log(props.mode);\n\n      if (e.key === 'r') props.createTempRiff('audio', props.videoID, true);\n      else if (e.key === 't') props.createTempRiff('text', props.videoID);\n      else if (props.mode === EDIT_MODE || props.mode === EDIT_NEW_MODE) return;\n      else if (e.key === 'j' || e.key === 'ArrowLeft' || e.key === 'Left')\n        // I actually took MS specific BS into account\n        window.rifftubePlayer.seekTo(\n          Math.max(window.rifftubePlayer.getCurrentTime() - 5, 0),\n          true\n        );\n      else if (e.key === 'l' || e.key === 'ArrowRight' || e.key === 'Right')\n        window.rifftubePlayer.seekTo(\n          Math.min(window.rifftubePlayer.getCurrentTime() + 5, props.duration),\n          true\n        );\n      else if (e.key === ' ' || e.key === 'k') {\n        props.togglePlayerMode();\n        e.preventDefault();\n      }\n    };\n    window.addEventListener('keydown', keydownEvent);\n\n    return () => {\n      window.removeEventListener('blur', blurEvent);\n      window.removeEventListener('keydown', keydownEvent);\n    };\n  }, [props]);\n\n  return (\n    <div className=\"control-panel\">\n      {\n        // make this into a component?:\n        props.name ? (\n          <React.Fragment>\n            <div className=\"riffer-name\">\n              Riffer Name:&nbsp;\n              {props.name}\n            </div>\n            <GoogleLogout\n              clientId=\"941154439836-s6iglcrdckcj6od74kssqsom58j96hd8.apps.googleusercontent.com\"\n              buttonText=\"Logout\"\n              onLogoutSuccess={() => props.googleUserLogout()}\n            ></GoogleLogout>\n          </React.Fragment>\n        ) : null\n      }\n\n      {/* to add back later <Collaboration /> */}\n\n      <div>\n        <h2 className=\"add-riff-title\">Add New Riff</h2>\n        {\n          props.recorder !== null ?\n            <RiffButton type=\"audio\" />\n          :\n            <button onClick={() => {\n              var AudioContext =\n                window.AudioContext || window.webkitAudioContext; // Default // Safari and old versions of Chrome\n              var audioContext = new AudioContext();\n              if (navigator.mediaDevices) {\n                navigator.mediaDevices\n                  .getUserMedia({ audio: true, video: false })\n                  .then((stream) => {\n                    // gum (get user media)\n                    var input = audioContext.createMediaStreamSource(stream);\n                \n                    var recorder = new window.WebAudioRecorder(input, {\n                      workerDir: '/lib/',\n                      encoding: 'mp3',\n                      onEncoderLoading: (recorder, encoding) => {\n                        // show \"loading encoder...\" display\n                        console.log('Loading ' + encoding + ' encoder...');\n                      },\n                      onEncoderLoaded: (recorder, encoding) => {\n                        // hide \"loading encoder...\" display\n                        console.log(encoding + ' encoder loaded');\n                      },\n                    });\n                    props.setRecorder(recorder);\n                  })\n                  .catch(function (err) {\n                    //enable the record button if getUSerMedia() fails\n                    console.log(\"oops, can't get stream\", err);\n                  });\n              }\n            }}>\n              Click to allow recording\n            </button>\n        }\n        <RiffButton type=\"text\" />\n\n        {props.mode === EDIT_MODE || props.mode === EDIT_NEW_MODE ? (\n          <EditRiff />\n        ) : null}\n      </div>\n      <h2 className=\"riff-list-title\">Control Panel</h2>\n      <RiffList />\n    </div>\n  );\n}\n\nlet mapStateToProps = (state) => ({\n  mode: state.mode,\n  name: state.name,\n  googleUser: state.googleUser,\n  videoID: state.videoID,\n  duration: state.duration,\n  recorder: state.recorder,\n});\n\nconst mapDispatchToProps = {\n  setRifferName,\n  googleUserLogout,\n  createTempRiff,\n  togglePlayerMode,\n  setRecorder,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditControls);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}