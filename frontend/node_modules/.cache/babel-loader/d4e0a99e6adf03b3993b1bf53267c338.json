{"ast":null,"code":"import _toConsumableArray from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/davidnewberry/Documents/test_rails/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import ViewFilter from'./ViewFilter';var AuthorSelector=/*#__PURE__*/function(_React$Component){_inherits(AuthorSelector,_React$Component);var _super=_createSuper(AuthorSelector);function AuthorSelector(_props){var _this;_classCallCheck(this,AuthorSelector);_this=_super.call(this,_props);_this.setMute=function(id,mute){_this.setState(function(state,props){// new state\nvar m=_objectSpread(_objectSpread({},state.muted),{},_defineProperty({},id,mute));// const temp = props.riffs.filter((el) => !m[el.user_id]);\nreturn{muted:m,filteredRiffs:props.riffs.filter(function(el){return!m[el.user_id];}),all:false};});};_this.toggleMute=function(id){//this.setMute(id, !this.state.muted[id]);\ndebugger;var m=_objectSpread(_objectSpread({},_this.state.muted),{},_defineProperty({},id,!_this.state.muted[id]));// not muted\nvar nm2=_this.state.names.map(function(el){return el.id;});var nm=nm2.filter(function(el){return!m[el];});var nmStr='?solo='+nm.join(',');_this.props.history.push(\"/view/\".concat(_this.props.videoID).concat(nmStr));};_this.state={names:[],muted:{},filteredRiffs:[],all:true};return _this;}_createClass(AuthorSelector,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this2=this;debugger;/*\n    if (\n      prevState.muted !== this.state.muted ||\n      prevState.all !== this.state.all\n    ) {\n      if (this.state.all) {\n        this.props.history.push(`/view/${this.props.videoID}`);\n      } else {\n        // new muted state\n        const m = { ...this.state.muted };\n\n        // not muted\n        const nm2 = this.state.names.map((el) => el.id);\n        const nm = nm2.filter((el) => !m[el]);\n        const nmStr = '?solo=' + nm.join(',');\n\n        this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n      }\n    }\n    */var rifferList=this.props.riffers?this.props.riffers.indexOf(',')>=0?this.props.riffers.split(','):[this.props.riffers]:[];if(prevProps.riffers!==this.props.riffers){var m={};this.state.names.forEach(function(el){m[el.id]=!(rifferList.includes(String(el.id))||_this2.props.riffers===undefined);});this.setState({muted:m,all:this.props.riffers===undefined,filteredRiffs:this.props.riffs.filter(function(el){return!m[el.user_id];})});}if(prevProps.timestamp!==this.props.timestamp||prevProps.riffs.length===0&&this.props.riffs.length>0){//( prevProps.riffs !== this.props.riffs )\nvar includes=function includes(arr,id){return arr.some(function(el){return el.id===id;});};var names=_toConsumableArray(this.state.names);var _m=_objectSpread({},this.state.muted);this.props.riffs.forEach(function(riff){if(!includes(names,riff.user_id)){names.push({name:riff.name,id:riff.user_id});if(_this2.props.riffers!==undefined){_m[riff.user_id]=!rifferList.some(function(riffer){return riff.user_id===Number(riffer);});}}});this.setState({names:names,muted:_m,all:this.props.riffers===undefined,filteredRiffs:this.props.riffers===undefined?this.props.riffs:this.props.riffs.filter(function(el){return!_m[el.user_id];})});}}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ViewFilter,{id:this.props.videoID,duration:this.props.duration,riffs:this.state.filteredRiffs}),/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){if(!_this3.state.all)_this3.props.history.push(\"/view/\".concat(_this3.props.videoID));else{var nm2=_this3.state.names.map(function(el){return el.id;});var nm=nm2.filter(function(el){return!_this3.state.muted[el];});var nmStr=nm.join(',');_this3.props.history.push(\"/view/\".concat(_this3.props.videoID,\"?solo=\").concat(nmStr));}},style:{backgroundColor:this.state.all?'blue':'gray'}},\"All\"),this.state.names.map(function(el){return/*#__PURE__*/React.createElement(\"div\",{key:el.id,onClick:function onClick(){return _this3.toggleMute(el.id);},style:{backgroundColor:_this3.state.muted[el.id]?'gray':'blue'}},el.name);}));}}]);return AuthorSelector;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{timestamp:state.riffs.timestamp};};export default connect(mapStateToProps,null)(AuthorSelector);","map":{"version":3,"names":["React","connect","ViewFilter","AuthorSelector","props","setMute","id","mute","setState","state","m","muted","filteredRiffs","riffs","filter","el","user_id","all","toggleMute","nm2","names","map","nm","nmStr","join","history","push","videoID","prevProps","prevState","rifferList","riffers","indexOf","split","forEach","includes","String","undefined","timestamp","length","arr","some","riff","name","riffer","Number","duration","backgroundColor","Component","mapStateToProps"],"sources":["/Users/davidnewberry/Documents/test_rails/frontend/src/components/ViewInterface/AuthorSelector.js"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport ViewFilter from './ViewFilter';\n\nclass AuthorSelector extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { names: [], muted: {}, filteredRiffs: [], all: true };\n  }\n\n  setMute = (id, mute) => {\n    this.setState((state, props) => {\n      // new state\n      const m = { ...state.muted, [id]: mute };\n\n      // const temp = props.riffs.filter((el) => !m[el.user_id]);\n\n      return {\n        muted: m,\n        filteredRiffs: props.riffs.filter((el) => !m[el.user_id]),\n        all: false,\n      };\n    });\n  };\n\n  toggleMute = (id) => {\n    //this.setMute(id, !this.state.muted[id]);\n\n    debugger;\n\n    const m = { ...this.state.muted, [id]: !this.state.muted[id] };\n\n    // not muted\n    const nm2 = this.state.names.map((el) => el.id);\n    const nm = nm2.filter((el) => !m[el]);\n    const nmStr = '?solo=' + nm.join(',');\n\n    this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    debugger;\n\n    /*\n    if (\n      prevState.muted !== this.state.muted ||\n      prevState.all !== this.state.all\n    ) {\n      if (this.state.all) {\n        this.props.history.push(`/view/${this.props.videoID}`);\n      } else {\n        // new muted state\n        const m = { ...this.state.muted };\n\n        // not muted\n        const nm2 = this.state.names.map((el) => el.id);\n        const nm = nm2.filter((el) => !m[el]);\n        const nmStr = '?solo=' + nm.join(',');\n\n        this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n      }\n    }\n    */\n\n    const rifferList = this.props.riffers\n      ? this.props.riffers.indexOf(',') >= 0\n        ? this.props.riffers.split(',')\n        : [this.props.riffers]\n      : [];\n\n    if (prevProps.riffers !== this.props.riffers) {\n      const m = {};\n      this.state.names.forEach((el) => {\n        m[el.id] = !(\n          rifferList.includes(String(el.id)) || this.props.riffers === undefined\n        );\n      });\n      this.setState({\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs: this.props.riffs.filter((el) => !m[el.user_id]),\n      });\n    }\n\n    if (\n      prevProps.timestamp !== this.props.timestamp ||\n      (prevProps.riffs.length === 0 && this.props.riffs.length > 0)\n    ) {\n      //( prevProps.riffs !== this.props.riffs )\n      const includes = (arr, id) => arr.some((el) => el.id === id);\n\n      var names = [...this.state.names];\n\n      const m = { ...this.state.muted };\n\n      this.props.riffs.forEach((riff) => {\n        if (!includes(names, riff.user_id)) {\n          names.push({ name: riff.name, id: riff.user_id });\n\n          if (this.props.riffers !== undefined) {\n            m[riff.user_id] = !rifferList.some(\n              (riffer) => riff.user_id === Number(riffer)\n            );\n          }\n        }\n      });\n      this.setState({\n        names,\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs:\n          this.props.riffers === undefined\n            ? this.props.riffs\n            : this.props.riffs.filter((el) => !m[el.user_id]),\n      });\n    }\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <ViewFilter\n          id={this.props.videoID}\n          duration={this.props.duration}\n          riffs={this.state.filteredRiffs}\n        />\n        <div\n          onClick={() => {\n            if (!this.state.all)\n              this.props.history.push(`/view/${this.props.videoID}`);\n            else {\n              const nm2 = this.state.names.map((el) => el.id);\n              const nm = nm2.filter((el) => !this.state.muted[el]);\n              const nmStr = nm.join(',');\n\n              this.props.history.push(\n                `/view/${this.props.videoID}?solo=${nmStr}`\n              );\n            }\n          }}\n          style={{\n            backgroundColor: this.state.all ? 'blue' : 'gray',\n          }}\n        >\n          All\n        </div>\n        {this.state.names.map((el) => (\n          <div\n            key={el.id}\n            onClick={() => this.toggleMute(el.id)}\n            style={{\n              backgroundColor: this.state.muted[el.id] ? 'gray' : 'blue',\n            }}\n          >\n            {el.name}\n          </div>\n        ))}\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  timestamp: state.riffs.timestamp,\n});\n\nexport default connect(mapStateToProps, null)(AuthorSelector);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}